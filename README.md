# Protein Group Annotation with UniProt + LLM

## About
This repository provides a quick pipeline to:
1. Query the **UniProt REST API** to fetch annotations (GO terms, Pfam domains, Reactome pathways, etc.) for a set of proteins.  
2. Use an **LLM (OpenAI GPT models)** to assign concise, human-readable **group labels** for protein groups based on their functional annotations.

This workflow is useful for summarizing functional clusters of proteins (e.g., from network analysis, clustering, or similarity searches) into interpretable group names.

---

## Repository Files
- **`gene_to_uniprot_mapping.py`**  
  Maps gene symbols to UniProt accessions and fetches annotation data (GO/Pfam/Reactome). Saves results as a CSV.

- **`LLM_based_group_annotation.py`**  
  Uses the UniProt annotation file plus protein group definitions (e.g., top-10 neighbors) to generate prompts for the LLM. The model then assigns a group name for each set of proteins.

- **`example_input_top10.csv`**  
  Example list of proteins and their closest neighbors.

- **`example_input_commonpathways.csv`**  
  Example pathways shared across protein groups.

- **`example_output_labelmapping.csv`**  
  Example UniProt annotations retrieved for proteins.

- **`example_output_LLMassignedgroup.csv`**  
  Example group names generated by the LLM.

---

## Installation
Clone the repo and install dependencies:
```bash
git clone https://github.com/<your-username>/protein-group-annotation.git
cd protein-group-annotation

pip install -r requirements.txt
```

### Requirements
- `pandas`  
- `requests`  
- `openai`  

Make sure you have an OpenAI API key set as an environment variable:
```bash
export OPENAI_API_KEY="your_api_key_here"
```

---

## Usage

### Step 1. Fetch UniProt annotations
```bash
python gene_to_uniprot_mapping.py
```
This script:
- Maps input gene symbols → UniProt IDs  
- Fetches annotations (GO, Pfam, keywords, Reactome)  
- Saves results to `example_output_labelmapping.csv`

---

### Step 2. Assign functional group labels with LLM
```bash
python LLM_based_group_annotation.py
```
This script:
- Reads the input proteins and UniProt annotations  
- Builds an LLM prompt for each group  
- Runs GPT to assign group labels  
- Saves results to `example_output_LLMassignedgroup.csv`

---

## Example LLM Prompt
Here’s a preview of the kind of prompt the script generates and sends to ChatGPT:

```
Group proteins: A1BG, AADACL3, AAMP

Annotations:
- A1BG
  Gene Ontology (biological process): immune response-regulating signaling pathway
  Gene Ontology (cellular component): extracellular region
- AADACL3
  Gene Ontology (molecular function): carboxylic ester hydrolase activity
  Protein families: Aryldialkylphosphatase family
- AAMP
  Reactome: Integrin cell surface interactions

Task: Based on the annotations, assign a concise, human-readable group name 
(like a Gene Ontology or Pfam family label) that best captures their shared function.
```

Example model output:
```
Extracellular Signaling and Lipid Metabolism Proteins
```

---

## Example Results
The output file `example_output_LLMassignedgroup.csv` looks like this:

| Group_Label                                  |
|----------------------------------------------|
| Extracellular Signaling and Lipid Metabolism |
| Cytoskeleton and Angiogenesis Regulators      |
| Ion Transporters                             |

---

## Notes
- The scripts are modular: you can plug in your own protein lists.  
- Rate limiting may apply when querying UniProt; batching and delays are built in.  
- For reproducibility, you may want to cache UniProt queries locally.  
